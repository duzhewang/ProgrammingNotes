MySQL:

```
Select Q.query_name, round(avg(Q.rating/Q.position), 2) as quality, round(num_rating/count(Q.query_name)*100,2) as poor_query_percentage 
from Queries as Q join 
(Select query_name, count(rating) as num_rating
from Queries
where rating<3 
group by query_name 
) as T
on Q.query_name=T.query_name
group by query_name;  
```
